<ContentDialog
    x:Class="MyShopClient.Views.Employees.AddEmployeeDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:MyShopClient.Views.Employees"
    xmlns:viewmodels="using:MyShopClient.ViewModels"
    xmlns:helpers="using:MyShopClient.Helpers"
    Title="{x:Bind ViewModel.DialogTitle, Mode=OneWay}"
    PrimaryButtonText="Save"
    SecondaryButtonText="Cancel"
    DefaultButton="Primary"
    Style="{StaticResource DefaultContentDialogStyle}"
    RequestedTheme="{x:Bind RequestedTheme, Mode=OneWay}"
    PrimaryButtonClick="ContentDialog_PrimaryButtonClick"
    SecondaryButtonClick="ContentDialog_SecondaryButtonClick">
    
    <ContentDialog.Resources>
        <helpers:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        
        <!-- Form Label Style -->
        <Style x:Key="FormLabelStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{ThemeResource TextPrimaryBrush}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Margin" Value="0,0,0,6"/>
        </Style>
        
        <!-- Required Indicator Style -->
        <Style x:Key="RequiredIndicatorStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{ThemeResource DangerBrush}"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="2,0,0,0"/>
        </Style>
    </ContentDialog.Resources>
    
    <ScrollViewer 
        VerticalScrollBarVisibility="Auto" 
        HorizontalScrollBarVisibility="Disabled"
        MaxHeight="450">
        
        <StackPanel Spacing="20" Width="400" Padding="8,8,16,0">
            
            <!-- Error Message Banner -->
            <InfoBar
                IsOpen="{x:Bind ViewModel.HasErrors, Mode=OneWay}"
                Severity="Error"
                Title="Validation Error"
                Message="{x:Bind ViewModel.ErrorMessage, Mode=OneWay}"
                IsClosable="False"/>
            
            <!-- Username Field -->
            <StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Username" Style="{StaticResource FormLabelStyle}"/>
                    <TextBlock Text="*" Style="{StaticResource RequiredIndicatorStyle}"/>
                </StackPanel>
                <TextBox 
                    PlaceholderText="Enter username..."
                    Text="{x:Bind ViewModel.Username, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    HorizontalAlignment="Stretch"/>
            </StackPanel>
            
            <!-- Password Field -->
            <StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Password" Style="{StaticResource FormLabelStyle}"/>
                    <TextBlock Text="*" Style="{StaticResource RequiredIndicatorStyle}"
                               Visibility="{x:Bind ViewModel.IsEditMode, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverse}"/>
                </StackPanel>
                <PasswordBox 
                    PlaceholderText="{x:Bind PasswordPlaceholder, Mode=OneWay}"
                    Password="{x:Bind ViewModel.Password, Mode=TwoWay}"
                    HorizontalAlignment="Stretch"/>
                <TextBlock 
                    Text="Leave blank to keep current password"
                    FontSize="11"
                    Foreground="{ThemeResource TextSecondaryBrush}"
                    Margin="0,4,0,0"
                    Visibility="{x:Bind ViewModel.IsEditMode, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
            </StackPanel>
            
            <!-- Confirm Password Field -->
            <StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Confirm Password" Style="{StaticResource FormLabelStyle}"/>
                </StackPanel>
                <PasswordBox 
                    PlaceholderText="Confirm password..."
                    Password="{x:Bind ViewModel.ConfirmPassword, Mode=TwoWay}"
                    HorizontalAlignment="Stretch"/>
            </StackPanel>
            
            <!-- Role Selection -->
            <StackPanel>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Role" Style="{StaticResource FormLabelStyle}"/>
                    <TextBlock Text="*" Style="{StaticResource RequiredIndicatorStyle}"/>
                </StackPanel>
                <ComboBox 
                    ItemsSource="{x:Bind ViewModel.Roles}"
                    SelectedItem="{x:Bind ViewModel.SelectedRole, Mode=TwoWay}"
                    HorizontalAlignment="Stretch">
                    <ComboBox.ItemTemplate>
                        <DataTemplate x:DataType="x:String">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon 
                                    Glyph="{x:Bind local:AddEmployeeDialog.GetRoleIcon((x:String))}" 
                                    FontSize="16"/>
                                <TextBlock Text="{x:Bind local:AddEmployeeDialog.GetRoleDisplayName((x:String))}"/>
                            </StackPanel>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
            </StackPanel>
            
            <!-- Loading Indicator -->
            <ProgressBar 
                IsIndeterminate="True"
                Visibility="{x:Bind ViewModel.IsSaving, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"/>
            
        </StackPanel>
    </ScrollViewer>
</ContentDialog>
